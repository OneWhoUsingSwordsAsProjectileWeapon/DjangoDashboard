{% load listing_extras %}

<style>
    /* Базовые стили */
    .pricing-container {
        font-family: 'Helvetica Neue', Arial, sans-serif;
        color: #333;
        padding: 16px;
        border-radius: 8px;
        background-color: #f8f9fa;
        border: 1px solid #e0e0e0;
        min-height: 200px;
    }
    
    /* Стили строк */
    .price-line {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
    }
    
    /* Итоговая строка */
    .price-total {
        font-weight: bold;
        margin-top: 12px;
        padding-top: 12px;
        border-top: 2px solid #ddd;
        font-size: 1.1em;
    }
    
    /* Стили для цен */
    .price-value {
        font-weight: 600;
        color: #2a6496;
    }
    
    /* Уведомления */
    .price-notice {
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 14px;
        margin-top: 16px;
    }
    
    .notice-success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    
    .notice-error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }
    
    .notice-info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
    }
    
    /* Иконки */
    .price-icon {
        margin-right: 5px;
    }
</style>

<div class="pricing-container">
    {% if check_in and check_out %}
        <!-- Рассчитанные цены -->
        <div class="price-line">
            <span>
                {{ nights }} ноч{{ nights|pluralize:"ь,и,ей" }} по {{ base_price_per_night|currency }}
            </span>
            <span class="price-value">{{ base_price|currency }}</span>
        </div>
        
        <div class="price-line">
            <span>Плата за уборку</span>
            <span class="price-value">{{ cleaning_fee|currency }}</span>
        </div>
        
        <div class="price-line">
            <span>Сервисный сбор</span>
            <span class="price-value">{{ service_fee|currency }}</span>
        </div>
        
        <div class="price-line price-total">
            <span>Итого</span>
            <span class="price-value">{{ total_price|currency }}</span>
        </div>
        
        {% if is_available %}
            <div class="price-notice notice-success">
                <i class="fas fa-check-circle price-icon"></i> Эти даты доступны!
            </div>
        {% else %}
            <div class="price-notice notice-error">
                <i class="fas fa-exclamation-circle price-icon"></i> Некоторые или все эти даты недоступны.
            </div>
        {% endif %}
    {% else %}
        <!-- Цены по умолчанию -->
        <div class="price-line">
            <span>{{ listing.price_per_night|currency }} × 0 ночей</span>
            <span>₽0.00</span>
        </div>
        
        <div class="price-line">
            <span>Плата за уборку</span>
            <span>{{ listing.cleaning_fee|currency }}</span>
        </div>
        
        <div class="price-line">
            <span>Сервисный сбор</span>
            <span>{{ listing.service_fee|currency }}</span>
        </div>
        
        <div class="price-line price-total">
            <span>Итого</span>
            <span>{{ listing.cleaning_fee|add:listing.service_fee|currency }}</span>
        </div>
        
        <div class="price-notice notice-info">
            <i class="fas fa-info-circle price-icon"></i> Выберите даты, чтобы увидеть общую стоимость.
        </div>
    {% endif %}
</div>